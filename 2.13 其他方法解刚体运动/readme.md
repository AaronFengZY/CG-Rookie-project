# 实验题目：更好地求解运动方程

前向欧拉法在求解运动方程时，其误差会随着迭代时间的增长而变得更加明显。因此，我们需要寻找一些更好的近似方法来提高求解的准确性。


# 数值积分方法介绍

在计算物理和动画中，数值积分方法用于近似求解动力学方程。以下是三种常用的数值积分方法的简介：

## 1. Backward Euler Method (后向欧拉法)

`backward_euler_step` 方法是一种隐式的数值积分方法，它在计算下一个状态时使用的是未来的信息。相比于前向欧拉法，它在处理刚体动力学和大时间步长时更稳定。其基本公式为：

$$
x_{k+1} = x_k + v_{k+1}\Delta t
$$
$$
v_{k+1} = v_k + a_{k+1}\Delta t
$$

其中，$a_{k+1}$ 是在 $x_{k+1}$ 和 $v_{k+1}$ 处计算的加速度。

## 2. Symplectic Euler Method (辛欧拉法)

`symplectic_euler_step` 方法是一种半隐式的数值积分方法，它先更新速度，再更新位置。这种方法对于某些物理系统来说保守了更多的能量，特别适用于哈密顿系统的积分。其公式为：

$$
v_{k+1} = v_k + a_k\Delta t
$$
$$
x_{k+1} = x_k + v_{k+1}\Delta t
$$

## 3. Runge-Kutta Method (龙格-库塔法)

`runge_kutta_step` 方法是一种更精确的积分方法，通常指的是四阶龙格-库塔法。它通过在每一步内多次估计斜率来提高精度。适用于需要高精度计算的系统，但计算量较大。其基本思想是综合多个不同点的斜率信息来估计下一个值。

### 四阶龙格-库塔法（RK4）求解

四阶龙格-库塔法（RK4）是一种用于求解常微分方程的方法，它通过结合多个中间步骤的结果来提高求解的准确性。对于方程 $x_{k+1} = x_k + v\Delta t$ 和 $v_{k+1} = v_k + a\Delta t$，RK4的一般步骤如下：

1. **初始化**：设定初值 $x_0$ 和 $v_0$。

2. **计算四个斜率**：

   - $k_1 = \Delta t \cdot f(x_k, v_k)$
   - $k_2 = \Delta t \cdot f\left(x_k + \frac{1}{2} k_1, v_k + \frac{1}{2} k_1\right)$
   - $k_3 = \Delta t \cdot f\left(x_k + \frac{1}{2} k_2, v_k + \frac{1}{2} k_2\right)$
   - $k_4 = \Delta t \cdot f(x_k + k_3, v_k + k_3)$

3. **更新下一步值**：

   - $x_{k+1} = x_k + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)$
   - $v_{k+1} = v_k + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)$

其中 $f(x, v)$ 是描述系统动力学的函数。RK4方法通过这种方式有效地平衡了计算精度和计算量。

